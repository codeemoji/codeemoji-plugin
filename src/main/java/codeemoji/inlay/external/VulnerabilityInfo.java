package codeemoji.inlay.external;

public class VulnerabilityInfo {

    public enum ScannerType {
        OSS,
        NIST,
        OSV
    }

    private final ScannerType scanner;
    private final String cve;
    private final String description;
    private final Object severity;

    public VulnerabilityInfo(String cve, String description, Object severity, ScannerType scanner) {
        this.cve = cve;
        this.description = description;
        this.severity = severity;
        this.scanner = scanner;
    }

    public String getCve() {
        return cve;
    }

    public String getDescription() {
        return description;
    }

    public String getSeverity() {
        if (scanner == ScannerType.NIST) {
            return (String) severity;
        }
        else if (scanner == ScannerType.OSS) {
            Float score = (Float) severity;
            if (score <= 5.5f) {
                return "LOW";
            }
            else if (score <= 8.0f) {
                return "MEDIUM";
            }
            else if (score < 10.0f) {
                return "HIGH";
            }
            else if (score == 10.0f) {
                return "CRITICAL";
            }
            else if (score > 10.0) {
                return "ERROR";
            }
        } else if (scanner == ScannerType.OSV) {
            String score = (String) severity;
            if (severity.equals("MODERATE")) {
                return "MEDIUM";
            }
            return score;
        }
        return "ERROR";
    }

    public ScannerType getScanner() {
        return scanner;
    }
}
