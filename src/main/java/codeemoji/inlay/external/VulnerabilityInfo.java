package codeemoji.inlay.external;

public class VulnerabilityInfo {

    public enum ScannerType {
        OSS,
        NIST
    }

    private final ScannerType scanner;
    private final String cve;
    private final String description;
    private final Object severity;

    public VulnerabilityInfo(String cve, String description, Object severity, ScannerType scanner) {
        this.cve = cve;
        this.description = description;
        this.severity = severity;
        this.scanner = scanner;
    }

    public String getCve() {
        return cve;
    }

    public String getDescription() {
        return description;
    }

    public String getSeverity() {
        if (scanner == ScannerType.NIST) {
            return (String) severity;
        }
        else if (scanner != ScannerType.OSS) {
            Float score = (Float) severity;
            if (score <= 5.0) {
                return "LOW";
            }
            else if (score <= 7.5) {
                return "MEDIUM";
            }
            else if (score <= 9.0) {
                return "CRITICAL";
            }
            else if (score > 10.0) {
                return "ERROR";
            }
        }
        return null;
    }

    public ScannerType getScanner() {
        return scanner;
    }
}
